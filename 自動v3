-- ================= åŸºæœ¬æœå‹™ =================
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

-- ================= è¨­å®š =================
local TOGGLE_KEY = Enum.KeyCode.V   -- é–‹é—œéµï¼ˆVï¼Œå¯æ”¹æˆ X / Z / Fï¼‰
local AUTO_ENABLE = true            -- è¼‰å…¥è‡ªå‹•é–‹

-- ================= ç‹€æ…‹ =================
_G.V3_ENABLED = _G.V3_ENABLED or false
_G.V3_LOADED = _G.V3_LOADED or false

-- ================= è§’è‰²ç­‰å¾… =================
local function WaitForCharacter()
    return LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
end

-- ================= V3 åŠŸèƒ½å€ =================
local function EnableV3()
    if _G.V3_ENABLED then return end
    _G.V3_ENABLED = true

    -- ğŸ”¥ ä½ çš„ V3 å•Ÿå‹•å…§å®¹å¯«åœ¨é€™è£¡ ğŸ”¥
    print("âœ… V3 å·²é–‹å•Ÿ")

    -- ä¾‹å¦‚ï¼š
    -- Settings.V3 = true
    -- StartV3()
end

local function DisableV3()
    if not _G.V3_ENABLED then return end
    _G.V3_ENABLED = false

    -- âŒ é—œé–‰ V3 çš„å…§å®¹
    print("âŒ V3 å·²é—œé–‰")

    -- ä¾‹å¦‚ï¼š
    -- Settings.V3 = false
    -- StopV3()
end

-- ================= å¿«æ·éµåˆ‡æ› =================
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == TOGGLE_KEY then
        if _G.V3_ENABLED then
            DisableV3()
        else
            EnableV3()
        end
    end
end)

-- ================= è‡ªå‹•å•Ÿå‹• =================
if not _G.V3_LOADED then
    _G.V3_LOADED = true

    WaitForCharacter()
    task.wait(0.2)

    if AUTO_ENABLE then
        EnableV3()
    end
end

-- ================= é‡ç”Ÿè‡ªå‹•æ¢å¾© =================
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(0.2)
    if _G.V3_ENABLED then
        EnableV3()
    end
end)
